{"ast":null,"code":"import _objectSpread from\"/command-center/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/command-center/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/command-center/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/command-center/node_modules/@babel/runtime/regenerator/index.js\";import React from\"react\";import{Helmet}from\"react-helmet\";import{Loading,Error}from\"../../helper\";import{TascomFooter,AsideInformations,SimpleCard,UnitBedsCard}from\"../../components\";import useUnitBeds from\"../../service/useUnitBeds\";import useUnities from\"../../service/useUnities\";import useBedsSituation from\"../../service/useBedsSituation\";import useGeneralPercent from\"../../service/useGeneralPercent\";import useSanitationBeds from\"../../service/useSanitationBeds\";import{useScroll}from\"../../service/useScroll\";import useUtilities from\"../../service/useUtilities\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var BedMaps=function BedMaps(){var timeInterval=5000;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),loading=_React$useState2[0],setLoading=_React$useState2[1];var _React$useState3=React.useState(false),_React$useState4=_slicedToArray(_React$useState3,2),error=_React$useState4[0],setError=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),fetchEnd=_React$useState6[0],setFetchEnd=_React$useState6[1];var divBeds=React.useRef(null);var _React$useMemo=React.useMemo(useUtilities,[]),getPageDimensions=_React$useMemo.getPageDimensions;useScroll(divBeds,12,15000,function(){return setFetchEnd(true);});//General Percent\nvar _useGeneralPercent=useGeneralPercent(),getTotalUnit=_useGeneralPercent.getTotalUnit;var refGetTotalUnit=React.useRef(getTotalUnit);var _React$useState7=React.useState(),_React$useState8=_slicedToArray(_React$useState7,2),totalUnitData=_React$useState8[0],setTotalUnitData=_React$useState8[1];React.useEffect(function(){setLoading(true);function executeRequest(){return _executeRequest.apply(this,arguments);}function _executeRequest(){_executeRequest=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$refGetTotalUni,totalUnit;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return refGetTotalUnit.current();case 3:_yield$refGetTotalUni=_context.sent;totalUnit=_yield$refGetTotalUni.totalUnit;setTotalUnitData(totalUnit);setError(false);_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);setError(_context.t0.message);case 12:_context.prev=12;setLoading(false);return _context.finish(12);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,9,12,15]]);}));return _executeRequest.apply(this,arguments);}executeRequest();var interval=setInterval(function(){executeRequest();},timeInterval);return function(){clearInterval(interval);};},[]);//Sanitation beds\nvar _useSanitationBeds=useSanitationBeds(),getSanitationBeds=_useSanitationBeds.getSanitationBeds;var refGetSanitationBeds=React.useRef(getSanitationBeds);var _React$useState9=React.useState(),_React$useState10=_slicedToArray(_React$useState9,2),mediumTime=_React$useState10[0],setMediumTime=_React$useState10[1];React.useEffect(function(){setLoading(true);function executeRequest(){return _executeRequest2.apply(this,arguments);}function _executeRequest2(){_executeRequest2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$refGetSanitati,timesEnded;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return refGetSanitationBeds.current();case 3:_yield$refGetSanitati=_context2.sent;timesEnded=_yield$refGetSanitati.timesEnded;setMediumTime(timesEnded);setError(false);_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](0);setError(_context2.t0.message);case 12:_context2.prev=12;setLoading(false);return _context2.finish(12);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[0,9,12,15]]);}));return _executeRequest2.apply(this,arguments);}executeRequest();var interval=setInterval(function(){executeRequest();},timeInterval);return function(){clearInterval(interval);};},[]);//Beds Situation\nvar _useBedsSituation=useBedsSituation(),getBedsSituation=_useBedsSituation.getBedsSituation;var refGetBedsSituation=React.useRef(getBedsSituation);var _React$useState11=React.useState(),_React$useState12=_slicedToArray(_React$useState11,2),quantSituations=_React$useState12[0],setQuantSituations=_React$useState12[1];React.useEffect(function(){setLoading(true);function executeRequest(){return _executeRequest3.apply(this,arguments);}function _executeRequest3(){_executeRequest3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var _yield$refGetBedsSitu,formatedSituations;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return refGetBedsSituation.current();case 3:_yield$refGetBedsSitu=_context3.sent;formatedSituations=_yield$refGetBedsSitu.formatedSituations;setQuantSituations(formatedSituations);setError(false);_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](0);setError(_context3.t0.message);case 12:_context3.prev=12;setLoading(false);return _context3.finish(12);case 15:case\"end\":return _context3.stop();}}},_callee3,null,[[0,9,12,15]]);}));return _executeRequest3.apply(this,arguments);}executeRequest();var interval=setInterval(function(){executeRequest();},timeInterval);return function(){clearInterval(interval);};},[]);//unities\nvar _useUnities=useUnities(),getUnities=_useUnities.getUnities;var refGetUnities=React.useRef(getUnities);var _React$useState13=React.useState(),_React$useState14=_slicedToArray(_React$useState13,2),unities=_React$useState14[0],setUnities=_React$useState14[1];var _React$useState15=React.useState([]),_React$useState16=_slicedToArray(_React$useState15,2),pages=_React$useState16[0],setPages=_React$useState16[1];var _React$useState17=React.useState([]),_React$useState18=_slicedToArray(_React$useState17,2),totalPages=_React$useState18[0],setTotalPages=_React$useState18[1];React.useLayoutEffect(function(){setLoading(true);function executeRequest(){return _executeRequest4.apply(this,arguments);}function _executeRequest4(){_executeRequest4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _yield$refGetUnities$,_unit;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return refGetUnities.current();case 3:_yield$refGetUnities$=_context4.sent;_unit=_yield$refGetUnities$.unit;setUnities(_unit);setError(false);setPages(function(){var pages=[];_unit.forEach(function(){pages.push(1);});return pages;});_context4.next=13;break;case 10:_context4.prev=10;_context4.t0=_context4[\"catch\"](0);setError(_context4.t0.message);case 13:_context4.prev=13;setLoading(false);return _context4.finish(13);case 16:case\"end\":return _context4.stop();}}},_callee4,null,[[0,10,13,16]]);}));return _executeRequest4.apply(this,arguments);}if(!pages.length&&!totalPages.length){executeRequest();}if(fetchEnd){var incrementedPages=pages.map(function(page,index){if(page>totalPages[index]){return 1;}else{return++page;}});setPages(incrementedPages);setFetchEnd(false);}},[pages,totalPages,fetchEnd]);//Unit Beds\nvar _useUnitBeds=useUnitBeds(),getUnitBeds=_useUnitBeds.getUnitBeds;var refGetUnitBeds=React.useRef(getUnitBeds);var _React$useState19=React.useState([]),_React$useState20=_slicedToArray(_React$useState19,2),unit=_React$useState20[0],setUnit=_React$useState20[1];React.useLayoutEffect(function(){function executeRequest(){return _executeRequest5.apply(this,arguments);}function _executeRequest5(){_executeRequest5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var loopPages,loopBeds,limitItens;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:loopPages=totalPages;loopBeds=unit;limitItens=getPageDimensions().width<=900?3:10;try{unities===null||unities===void 0?void 0:unities.forEach(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(loopUnit,index){var _yield$refGetUnitBeds,unitBeds,totPages;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return refGetUnitBeds.current(loopUnit.unit,pages[index],limitItens);case 2:_yield$refGetUnitBeds=_context5.sent;unitBeds=_yield$refGetUnitBeds.unitBeds;totPages=_yield$refGetUnitBeds.totPages;setError(false);if(pages[index]<=totPages){unit[index]=unitBeds;loopPages[index]=totPages;}case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x,_x2){return _ref.apply(this,arguments);};}());setUnit(loopBeds);setTotalPages(loopPages);}catch(error){setError(error.message);}finally{setLoading(false);}case 4:case\"end\":return _context6.stop();}}},_callee6);}));return _executeRequest5.apply(this,arguments);}if(pages.length){executeRequest();}},[pages,unities,totalPages,unit,getPageDimensions]);//config cards\nvar titles=[{color:\"#FFFFFF\",title:\"Vago\"},{color:\"#D62F2F\",title:\"Ocupado\"},{color:\"#D09600\",title:\"Alta Hospitalar\"},{color:\"#109683\",title:\"Reservado\"},{color:\"#7C7C7C\",title:\"Alta médica\"},{color:\"#165590\",title:\"Higienização\"},{color:\"#65A42B\",title:\"Bloqueado/Manutenção\"},{color:\"#74603B\",title:\"Interd. Temp.\"}];var configUnities=!unities&&!unit.length?[]:unities.map(function(loopUnit,i){return _objectSpread(_objectSpread({},loopUnit),{},{beds:unit[i]});});var unitiesCards=unities&&configUnities.map(function(unitie){return/*#__PURE__*/_jsx(UnitBedsCard,{title:unitie.unit,percent:unitie.percentage,data:unitie.beds,className:\"h-8 items-center\",containerClass:\"items-center\",bedClass:\"w-22 h-8 rounded-md text-sm\"},unitie.unit);});var situationsCards=quantSituations===null||quantSituations===void 0?void 0:quantSituations.map(function(_ref2){var title=_ref2.title,value=_ref2.value,tooltip=_ref2.tooltip,color=_ref2.color;return/*#__PURE__*/_jsx(SimpleCard,{data:value,title:title,className:\"w-32 h-15 bg-opacity-50 \".concat(color,\" text-xslg font-semibold\"),dataClass:\"text-3xl\",toolTipConfig:{title:title,desc:tooltip}},title);});if(loading)return/*#__PURE__*/_jsx(Loading,{});return/*#__PURE__*/_jsxs(\"main\",{className:\"min-h-screen w-full flex flex-col justify-center\",children:[/*#__PURE__*/_jsxs(Helmet,{children:[/*#__PURE__*/_jsx(\"title\",{children:\"CMDC | Mapas de Leitos\"}),/*#__PURE__*/_jsx(\"meta\",{name:\"description\",content:\"Dashboard com o resumo de dados dos leitos.\"})]}),/*#__PURE__*/_jsxs(\"section\",{className:\"flex-1 flex flex-col justify-center\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid sm:grid-cols-9 grid-cols-4 justify-between gap-2 mt-3 w-full max-w-7xl mx-auto\",children:[/*#__PURE__*/_jsx(SimpleCard,{data:totalUnitData===null||totalUnitData===void 0?void 0:totalUnitData.TOH_ON_LINE,type:\"string\",title:\"% Ocupa\\xE7\\xE3o\",className:\"w-32 h-15 bg-opacity-50 text-red-500 text-xslg font-semibold\",dataClass:\"text-3xl\",toolTipConfig:{title:\"% Ocupação\",desc:\"Este card mostra  o percentual de ocupação de leitos, não considerando os leitos extras, HD's e Unidade Jardins. Código das unidades que não são consideradas (5,22,19,1,21,41). Fórmula do cálculo : leitos ocupados / (leitos extras ocupados + leitos operacionais) * 100\"}}),situationsCards,/*#__PURE__*/_jsx(SimpleCard,{data:mediumTime,type:\"time\",title:\"TM Libera\\xE7\\xE3o\",className:\"w-32 h-15 bg-opacity-50 text-white text-xslg font-semibold\",dataClass:\"text-3xl\",toolTipConfig:{title:\"TM Liberação\",desc:\"Este card faz o cálculo em cima dos somatórios dos tempos utilizados para a higienização de cada leito higienizado no dia, dividido pela quantidade total de leitos higienizados. Obs: Começa a ser contabilizado, quando concluiu a primeira higienização\"}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"px-5\",children:/*#__PURE__*/_jsx(\"div\",{ref:divBeds,className:\"flex flex-col gap-3 max-w-7xl mx-auto mt-3 h-full max-h-none sm:max-h-113 py-1 overflow-y-scroll scroll-hide\",children:unitiesCards})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(AsideInformations,{data:titles,labelClass:\"sm:justify-between justify-center sm:flex-row flex-col\",className:\"z-10 max-w-4xl m-auto text-xs\"}),/*#__PURE__*/_jsx(TascomFooter,{className:\"absolute bottom-0 left-0\"})]}),error&&/*#__PURE__*/_jsx(Error,{message:error})]});};export default BedMaps;","map":{"version":3,"sources":["/command-center/src/pages/BedMaps/BedMaps.jsx"],"names":["React","Helmet","Loading","Error","TascomFooter","AsideInformations","SimpleCard","UnitBedsCard","useUnitBeds","useUnities","useBedsSituation","useGeneralPercent","useSanitationBeds","useScroll","useUtilities","BedMaps","timeInterval","useState","loading","setLoading","error","setError","fetchEnd","setFetchEnd","divBeds","useRef","useMemo","getPageDimensions","getTotalUnit","refGetTotalUnit","totalUnitData","setTotalUnitData","useEffect","executeRequest","current","totalUnit","message","interval","setInterval","clearInterval","getSanitationBeds","refGetSanitationBeds","mediumTime","setMediumTime","timesEnded","getBedsSituation","refGetBedsSituation","quantSituations","setQuantSituations","formatedSituations","getUnities","refGetUnities","unities","setUnities","pages","setPages","totalPages","setTotalPages","useLayoutEffect","unit","forEach","push","length","incrementedPages","map","page","index","getUnitBeds","refGetUnitBeds","setUnit","loopPages","loopBeds","limitItens","width","loopUnit","unitBeds","totPages","titles","color","title","configUnities","i","beds","unitiesCards","unitie","percentage","situationsCards","value","tooltip","desc","TOH_ON_LINE"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { Helmet } from \"react-helmet\";\r\nimport { Loading, Error } from \"../../helper\";\r\nimport {\r\n  TascomFooter,\r\n  AsideInformations,\r\n  SimpleCard,\r\n  UnitBedsCard,\r\n} from \"../../components\";\r\nimport useUnitBeds from \"../../service/useUnitBeds\";\r\nimport useUnities from \"../../service/useUnities\";\r\nimport useBedsSituation from \"../../service/useBedsSituation\";\r\nimport useGeneralPercent from \"../../service/useGeneralPercent\";\r\nimport useSanitationBeds from \"../../service/useSanitationBeds\";\r\nimport { useScroll } from \"../../service/useScroll\";\r\nimport useUtilities from \"../../service/useUtilities\";\r\n\r\nconst BedMaps = () => {\r\n  const timeInterval = 5000;\r\n  const [loading, setLoading] = React.useState(false);\r\n  const [error, setError] = React.useState(false);\r\n  const [fetchEnd, setFetchEnd] = React.useState(false);\r\n  const divBeds = React.useRef(null);\r\n  const { getPageDimensions } = React.useMemo(useUtilities, []);\r\n\r\n  useScroll(divBeds, 12, 15000, () => setFetchEnd(true));\r\n\r\n  //General Percent\r\n  const { getTotalUnit } = useGeneralPercent();\r\n  const refGetTotalUnit = React.useRef(getTotalUnit);\r\n  const [totalUnitData, setTotalUnitData] = React.useState();\r\n\r\n  React.useEffect(() => {\r\n    setLoading(true);\r\n    async function executeRequest() {\r\n      try {\r\n        const { totalUnit } = await refGetTotalUnit.current();\r\n        setTotalUnitData(totalUnit);\r\n        setError(false);\r\n      } catch (error) {\r\n        setError(error.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    executeRequest();\r\n    const interval = setInterval(() => {\r\n      executeRequest();\r\n    }, timeInterval);\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, []);\r\n\r\n  //Sanitation beds\r\n  const { getSanitationBeds } = useSanitationBeds();\r\n  const refGetSanitationBeds = React.useRef(getSanitationBeds);\r\n  const [mediumTime, setMediumTime] = React.useState();\r\n\r\n  React.useEffect(() => {\r\n    setLoading(true);\r\n    async function executeRequest() {\r\n      try {\r\n        const { timesEnded } = await refGetSanitationBeds.current();\r\n        setMediumTime(timesEnded);\r\n        setError(false);\r\n      } catch (error) {\r\n        setError(error.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    executeRequest();\r\n    const interval = setInterval(() => {\r\n      executeRequest();\r\n    }, timeInterval);\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, []);\r\n\r\n  //Beds Situation\r\n  const { getBedsSituation } = useBedsSituation();\r\n  const refGetBedsSituation = React.useRef(getBedsSituation);\r\n  const [quantSituations, setQuantSituations] = React.useState();\r\n\r\n  React.useEffect(() => {\r\n    setLoading(true);\r\n    async function executeRequest() {\r\n      try {\r\n        const { formatedSituations } = await refGetBedsSituation.current();\r\n        setQuantSituations(formatedSituations);\r\n        setError(false);\r\n      } catch (error) {\r\n        setError(error.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    executeRequest();\r\n    const interval = setInterval(() => {\r\n      executeRequest();\r\n    }, timeInterval);\r\n\r\n    return () => {\r\n      clearInterval(interval);\r\n    };\r\n  }, []);\r\n\r\n  //unities\r\n  const { getUnities } = useUnities();\r\n  const refGetUnities = React.useRef(getUnities);\r\n  const [unities, setUnities] = React.useState();\r\n  const [pages, setPages] = React.useState([]);\r\n  const [totalPages, setTotalPages] = React.useState([]);\r\n\r\n  React.useLayoutEffect(() => {\r\n    setLoading(true);\r\n    async function executeRequest() {\r\n      try {\r\n        const { unit } = await refGetUnities.current();\r\n        setUnities(unit);\r\n        setError(false);\r\n        setPages(() => {\r\n          const pages = [];\r\n          unit.forEach(() => {\r\n            pages.push(1);\r\n          });\r\n          return pages;\r\n        });\r\n      } catch (error) {\r\n        setError(error.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n    if (!pages.length && !totalPages.length) {\r\n      executeRequest();\r\n    }\r\n\r\n    if (fetchEnd) {\r\n      const incrementedPages = pages.map((page, index) => {\r\n        if (page > totalPages[index]) {\r\n          return 1;\r\n        } else {\r\n          return ++page;\r\n        }\r\n      });\r\n      setPages(incrementedPages);\r\n      setFetchEnd(false);\r\n    }\r\n  }, [pages, totalPages, fetchEnd]);\r\n\r\n  //Unit Beds\r\n  const { getUnitBeds } = useUnitBeds();\r\n  const refGetUnitBeds = React.useRef(getUnitBeds);\r\n  const [unit, setUnit] = React.useState([]);\r\n\r\n  React.useLayoutEffect(() => {\r\n    async function executeRequest() {\r\n      const loopPages = totalPages;\r\n      const loopBeds = unit;\r\n      const limitItens = getPageDimensions().width <= 900 ? 3 : 10;\r\n      try {\r\n        unities?.forEach(async (loopUnit, index) => {\r\n          const { unitBeds, totPages } = await refGetUnitBeds.current(\r\n            loopUnit.unit,\r\n            pages[index],\r\n            limitItens\r\n          );\r\n          setError(false);\r\n\r\n          if (pages[index] <= totPages) {\r\n            unit[index] = unitBeds;\r\n            loopPages[index] = totPages;\r\n          }\r\n        });\r\n        setUnit(loopBeds);\r\n        setTotalPages(loopPages);\r\n      } catch (error) {\r\n        setError(error.message);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    if (pages.length) {\r\n      executeRequest();\r\n    }\r\n  }, [pages, unities, totalPages, unit, getPageDimensions]);\r\n\r\n  //config cards\r\n  const titles = [\r\n    { color: \"#FFFFFF\", title: \"Vago\" },\r\n    { color: \"#D62F2F\", title: \"Ocupado\" },\r\n    { color: \"#D09600\", title: \"Alta Hospitalar\" },\r\n    { color: \"#109683\", title: \"Reservado\" },\r\n    { color: \"#7C7C7C\", title: \"Alta médica\" },\r\n    { color: \"#165590\", title: \"Higienização\" },\r\n    { color: \"#65A42B\", title: \"Bloqueado/Manutenção\" },\r\n    { color: \"#74603B\", title: \"Interd. Temp.\" },\r\n  ];\r\n\r\n  const configUnities =\r\n    !unities && !unit.length\r\n      ? []\r\n      : unities.map((loopUnit, i) => {\r\n          return { ...loopUnit, beds: unit[i] };\r\n        });\r\n\r\n  const unitiesCards =\r\n    unities &&\r\n    configUnities.map((unitie) => {\r\n      return (\r\n        <UnitBedsCard\r\n          key={unitie.unit}\r\n          title={unitie.unit}\r\n          percent={unitie.percentage}\r\n          data={unitie.beds}\r\n          className=\"h-8 items-center\"\r\n          containerClass=\"items-center\"\r\n          bedClass=\"w-22 h-8 rounded-md text-sm\"\r\n        />\r\n      );\r\n    });\r\n\r\n  const situationsCards = quantSituations?.map(\r\n    ({ title, value, tooltip, color }) => (\r\n      <SimpleCard\r\n        key={title}\r\n        data={value}\r\n        title={title}\r\n        className={`w-32 h-15 bg-opacity-50 ${color} text-xslg font-semibold`}\r\n        dataClass=\"text-3xl\"\r\n        toolTipConfig={{\r\n          title: title,\r\n          desc: tooltip,\r\n        }}\r\n      />\r\n    )\r\n  );\r\n\r\n  if (loading) return <Loading />;\r\n\r\n  return (\r\n    <main className=\"min-h-screen w-full flex flex-col justify-center\">\r\n      <Helmet>\r\n        <title>CMDC | Mapas de Leitos</title>\r\n        <meta\r\n          name=\"description\"\r\n          content=\"Dashboard com o resumo de dados dos leitos.\"\r\n        />\r\n      </Helmet>\r\n      <section className=\"flex-1 flex flex-col justify-center\">\r\n        <div className=\"grid sm:grid-cols-9 grid-cols-4 justify-between gap-2 mt-3 w-full max-w-7xl mx-auto\">\r\n          <SimpleCard\r\n            data={totalUnitData?.TOH_ON_LINE}\r\n            type=\"string\"\r\n            title=\"% Ocupação\"\r\n            className=\"w-32 h-15 bg-opacity-50 text-red-500 text-xslg font-semibold\"\r\n            dataClass=\"text-3xl\"\r\n            toolTipConfig={{\r\n              title: \"% Ocupação\",\r\n              desc: \"Este card mostra  o percentual de ocupação de leitos, não considerando os leitos extras, HD's e Unidade Jardins. Código das unidades que não são consideradas (5,22,19,1,21,41). Fórmula do cálculo : leitos ocupados / (leitos extras ocupados + leitos operacionais) * 100\",\r\n            }}\r\n          />\r\n          {situationsCards}\r\n          <SimpleCard\r\n            data={mediumTime}\r\n            type=\"time\"\r\n            title=\"TM Liberação\"\r\n            className=\"w-32 h-15 bg-opacity-50 text-white text-xslg font-semibold\"\r\n            dataClass=\"text-3xl\"\r\n            toolTipConfig={{\r\n              title: \"TM Liberação\",\r\n              desc: \"Este card faz o cálculo em cima dos somatórios dos tempos utilizados para a higienização de cada leito higienizado no dia, dividido pela quantidade total de leitos higienizados. Obs: Começa a ser contabilizado, quando concluiu a primeira higienização\",\r\n            }}\r\n          />\r\n        </div>\r\n        <div className=\"px-5\">\r\n          <div\r\n            ref={divBeds}\r\n            className=\"flex flex-col gap-3 max-w-7xl mx-auto mt-3 h-full max-h-none sm:max-h-113 py-1 overflow-y-scroll scroll-hide\"\r\n          >\r\n            {unitiesCards}\r\n          </div>\r\n        </div>\r\n      </section>\r\n      <div className=\"relative\">\r\n        <AsideInformations\r\n          data={titles}\r\n          labelClass=\"sm:justify-between justify-center sm:flex-row flex-col\"\r\n          className=\"z-10 max-w-4xl m-auto text-xs\"\r\n        />\r\n        <TascomFooter className=\"absolute bottom-0 left-0\" />\r\n      </div>\r\n      {error && <Error message={error} />}\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default BedMaps;\r\n"]},"metadata":{},"sourceType":"module"}